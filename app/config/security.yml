security:
    encoders:
        'Application\Bundle\DefaultBundle\Entity\User':
            algorithm: sha512
            encode_as_base64: false
            iterations: 1
    providers:
        fos_userbundle:
            id: fos_user.user_provider.username

    firewalls:
        main:
            pattern: ^/
            oauth:
                failure_path: /login
                login_path: /login
                check_path: /connect_check
                provider: fos_userbundle
                resource_owners:
                    facebook: "/login/check-facebook"
                    google: "/login/check-google"
                oauth_user_provider:
                    service: app.provider.oauth
                success_handler: user.handler.login_handler

            form_login:
                login_path: fos_user_security_login
                check_path: fos_user_security_check
                provider: fos_userbundle
                csrf_token_generator: security.csrf.token_manager
                remember_me: true
                use_referer: true
                success_handler: user.handler.login_handler
            entry_point: user.login_entry_point
            remember_me:
                secret: "%secret%"
                lifetime: 31536000 # 365 days in seconds
                path: ~
                domain: ~
            logout:
                path: fos_user_security_logout
            anonymous:    true

    role_hierarchy:
        ROLE_MANAGER: ROLE_USER
        ROLE_VOLUNTEER: ROLE_USER

        ROLE_SONATA_SHOW_STATISTIC: ROLE_MANAGER
        ROLE_SONATA_MANUAL_TICKET_SELL: ROLE_MANAGER
        ROLE_SONATA_CHECK_TICKET: ROLE_MANAGER

        ROLE_SONATA_AUDIENCE_VIEWER:
            - ROLE_MANAGER
            - ROLE_APP_ADMIN_EVENT_AUDIENCE_LIST
            - ROLE_APP_ADMIN_EVENT_AUDIENCE_VIEW
        ROLE_SONATA_AUDIENCE_EDITOR:
            - ROLE_SONATA_AUDIENCE_VIEWER
            - ROLE_APP_ADMIN_EVENT_AUDIENCE_CREATE
            - ROLE_APP_ADMIN_EVENT_AUDIENCE_EDIT
        ROLE_SONATA_AUDIENCE_ADMIN:
            - ROLE_SONATA_AUDIENCE_EDITOR
            - ROLE_APP_ADMIN_EVENT_AUDIENCE_DELETE

        ROLE_SONATA_TICKET_COST_VIEWER:
            - ROLE_MANAGER
            - ROLE_APP_ADMIN_TICKET_COST_LIST
            - ROLE_APP_ADMIN_TICKET_COST_VIEW
        ROLE_SONATA_TICKET_COST_EDITOR:
            - ROLE_SONATA_TICKET_COST_VIEWER
            - ROLE_APP_ADMIN_TICKET_COST_CREATE
            - ROLE_APP_ADMIN_TICKET_COST_EDIT
        ROLE_SONATA_TICKET_COST_ADMIN:
            - ROLE_SONATA_TICKET_COST_EDITOR
            - ROLE_APP_ADMIN_TICKET_COST_DELETE

        ROLE_SONATA_EVENT_VIEWER:
            - ROLE_SONATA_TICKET_COST_VIEWER
            - ROLE_APP_ADMIN_EVENT_LIST
            - ROLE_APP_ADMIN_EVENT_VIEW
        ROLE_SONATA_EVENT_EDITOR:
            - ROLE_SONATA_EVENT_VIEWER
            - ROLE_SONATA_TICKET_COST_EDITOR
            - ROLE_APP_ADMIN_EVENT_CREATE
            - ROLE_APP_ADMIN_EVENT_EDIT
        ROLE_SONATA_EVENT_ADMIN:
            - ROLE_SONATA_EVENT_EDITOR
            - ROLE_SONATA_TICKET_COST_ADMIN
            - ROLE_APP_ADMIN_EVENT_DELETE

        ROLE_SONATA_GROUP_VIEWER:
            - ROLE_MANAGER
            - ROLE_APP_ADMIN_EVENT_GROUP_LIST
            - ROLE_APP_ADMIN_EVENT_GROUP_VIEW
        ROLE_SONATA_GROUP_EDITOR:
            - ROLE_SONATA_GROUP_VIEWER
            - ROLE_APP_ADMIN_EVENT_GROUP_CREATE
            - ROLE_APP_ADMIN_EVENT_GROUP_EDIT
        ROLE_SONATA_GROUP_ADMIN:
            - ROLE_SONATA_GROUP_EDITOR
            - ROLE_APP_ADMIN_EVENT_GROUP_DELETE

        ROLE_SONATA_REVIEW_VIEWER:
            - ROLE_MANAGER
            - ROLE_APP_ADMIN_REVIEW_LIST
            - ROLE_APP_ADMIN_REVIEW_VIEW
        ROLE_SONATA_REVIEW_EDITOR:
            - ROLE_SONATA_REVIEW_VIEWER
            - ROLE_APP_ADMIN_REVIEW_CREATE
            - ROLE_APP_ADMIN_REVIEW_EDIT
        ROLE_SONATA_REVIEW_ADMIN:
            - ROLE_SONATA_REVIEW_EDITOR
            - ROLE_APP_ADMIN_REVIEW_DELETE

        ROLE_SONATA_SPEAKER_VIEWER:
            - ROLE_MANAGER
            - ROLE_APP_ADMIN_SPEAKER_LIST
            - ROLE_APP_ADMIN_SPEAKER_VIEW
        ROLE_SONATA_SPEAKER_EDITOR:
            - ROLE_SONATA_SPEAKER_VIEWER
            - ROLE_APP_ADMIN_SPEAKER_CREATE
            - ROLE_APP_ADMIN_SPEAKER_EDIT
        ROLE_SONATA_SPEAKER_ADMIN:
            - ROLE_SONATA_SPEAKER_EDITOR
            - ROLE_APP_ADMIN_SPEAKER_DELETE

        ROLE_SONATA_EVENT_PAGE_VIEWER:
            - ROLE_MANAGER
            - ROLE_APP_ADMIN_EVENT_PAGE_LIST
            - ROLE_APP_ADMIN_EVENT_PAGE_VIEW
        ROLE_SONATA_EVENT_PAGE_EDITOR:
            - ROLE_SONATA_EVENT_PAGE_VIEWER
            - ROLE_APP_ADMIN_EVENT_PAGE_CREATE
            - ROLE_APP_ADMIN_EVENT_PAGE_EDIT
        ROLE_SONATA_EVENT_PAGE_ADMIN:
            - ROLE_SONATA_EVENT_PAGE_EDITOR
            - ROLE_APP_ADMIN_EVENT_PAGE_DELETE

        ROLE_SONATA_SPONSOR_VIEWER:
            - ROLE_MANAGER
            - ROLE_APP_ADMIN_SPONSOR_LIST
            - ROLE_APP_ADMIN_SPONSOR_VIEW
        ROLE_SONATA_SPONSOR_EDITOR:
            - ROLE_SONATA_SPONSOR_VIEWER
            - ROLE_APP_ADMIN_SPONSOR_CREATE
            - ROLE_APP_ADMIN_SPONSOR_EDIT
        ROLE_SONATA_SPONSOR_ADMIN:
            - ROLE_SONATA_SPONSOR_EDITOR
            - ROLE_APP_ADMIN_SPONSOR_DELETE

        ROLE_SONATA_SPONSOR_CATEGORY_VIEWER:
            - ROLE_MANAGER
            - ROLE_APP_ADMIN_CATEGORY_LIST
            - ROLE_APP_ADMIN_CATEGORY_VIEW
        ROLE_SONATA_SPONSOR_CATEGORY_EDITOR:
            - ROLE_SONATA_SPONSOR_CATEGORY_VIEWER
            - ROLE_APP_ADMIN_CATEGORY_CREATE
            - ROLE_APP_ADMIN_CATEGORY_EDIT
        ROLE_SONATA_SPONSOR_CATEGORY_ADMIN:
            - ROLE_SONATA_SPONSOR_CATEGORY_EDITOR
            - ROLE_APP_ADMIN_CATEGORY_DELETE

        ROLE_SONATA_MAIL_QUEUE_VIEWER:
            - ROLE_MANAGER
            - ROLE_APP_ADMIN_MAIL_QUEUE_LIST
            - ROLE_APP_ADMIN_MAIL_QUEUE_VIEW
        ROLE_SONATA_MAIL_QUEUE_EDITOR:
            - ROLE_SONATA_MAIL_QUEUE_VIEWER
            - ROLE_APP_ADMIN_MAIL_QUEUE_CREATE
            - ROLE_APP_ADMIN_MAIL_QUEUE_EDIT
        ROLE_SONATA_MAIL_QUEUE_ADMIN:
            - ROLE_SONATA_MAIL_QUEUE_EDITOR
            - ROLE_APP_ADMIN_MAIL_QUEUE_DELETE

        ROLE_SONATA_MAIL_VIEWER:
            - ROLE_SONATA_MAIL_QUEUE_VIEWER
            - ROLE_APP_ADMIN_MAIL_LIST
            - ROLE_APP_ADMIN_MAIL_VIEW
        ROLE_SONATA_MAIL_EDITOR:
            - ROLE_SONATA_MAIL_VIEWER
            - ROLE_SONATA_MAIL_QUEUE_EDITOR
            - ROLE_APP_ADMIN_MAIL_CREATE
            - ROLE_APP_ADMIN_MAIL_EDIT
        ROLE_SONATA_MAIL_ADMIN:
            - ROLE_SONATA_MAIL_EDITOR
            - ROLE_SONATA_MAIL_QUEUE_ADMIN
            - ROLE_APP_ADMIN_MAIL_DELETE

        ROLE_SONATA_TICKET_VIEWER:
            - ROLE_MANAGER
            - ROLE_APP_ADMIN_TICKET_LIST
            - ROLE_APP_ADMIN_TICKET_VIEW
        ROLE_SONATA_TICKET_EDITOR:
            - ROLE_SONATA_TICKET_VIEWER
            - ROLE_APP_ADMIN_TICKET_CREATE
            - ROLE_APP_ADMIN_TICKET_EDIT
        ROLE_SONATA_TICKET_ADMIN:
            - ROLE_SONATA_TICKET_EDITOR
            - ROLE_APP_ADMIN_TICKET_DELETE

        ROLE_SONATA_PAYMENT_VIEWER:
            - ROLE_MANAGER
            - ROLE_APP_ADMIN_PAYMENT_LIST
            - ROLE_APP_ADMIN_PAYMENT_VIEW
        ROLE_SONATA_PAYMENT_EDITOR:
            - ROLE_SONATA_PAYMENT_VIEWER
            - ROLE_APP_ADMIN_PAYMENT_CREATE
            - ROLE_APP_ADMIN_PAYMENT_EDIT
        ROLE_SONATA_PAYMENT_ADMIN:
            - ROLE_SONATA_PAYMENT_EDITOR
            - ROLE_APP_ADMIN_PAYMENT_DELETE

        ROLE_SONATA_PROMO_CODE_VIEWER:
            - ROLE_MANAGER
            - ROLE_APP_ADMIN_PROMO_CODE_LIST
            - ROLE_APP_ADMIN_PROMO_CODE_VIEW
        ROLE_SONATA_PROMO_CODE_EDITOR:
            - ROLE_SONATA_PROMO_CODE_VIEWER
            - ROLE_APP_ADMIN_PROMO_CODE_CREATE
            - ROLE_APP_ADMIN_PROMO_CODE_EDIT
        ROLE_SONATA_PROMO_CODE_ADMIN:
            - ROLE_SONATA_PROMO_CODE_EDITOR
            - ROLE_APP_ADMIN_PROMO_CODE_DELETE

        ROLE_SONATA_USER_VIEWER:
            - ROLE_MANAGER
            - ROLE_APP_ADMIN_USER_LIST
            - ROLE_APP_ADMIN_USER_VIEW
        ROLE_SONATA_USER_EDITOR:
            - ROLE_SONATA_USER_VIEWER
            - ROLE_APP_ADMIN_USER_CREATE
            - ROLE_APP_ADMIN_USER_EDIT
        ROLE_SONATA_USER_ADMIN:
            - ROLE_SONATA_USER_EDITOR
            - ROLE_APP_ADMIN_USER_DELETE

        ROLE_SONATA_PAGE_VIEWER:
            - ROLE_MANAGER
            - ROLE_APP_ADMIN_PAGE_LIST
            - ROLE_APP_ADMIN_PAGE_VIEW
        ROLE_SONATA_PAGE_EDITOR:
            - ROLE_SONATA_PAGE_VIEWER
            - ROLE_APP_ADMIN_PAGE_CREATE
            - ROLE_APP_ADMIN_PAGE_EDIT
        ROLE_SONATA_PAGE_ADMIN:
            - ROLE_SONATA_PAGE_EDITOR
            - ROLE_APP_ADMIN_PAGE_DELETE

        ROLE_SONATA_TRANSLATION_VIEWER:
            - ROLE_MANAGER
            - ROLE_IBROWS_SONATA_TRANSLATION_ADMIN_ORM_LIST
            - ROLE_IBROWS_SONATA_TRANSLATION_ADMIN_ORM_VIEW
        ROLE_SONATA_TRANSLATION_EDITOR:
            - ROLE_SONATA_TRANSLATION_VIEWER
            - ROLE_IBROWS_SONATA_TRANSLATION_ADMIN_ORM_CREATE
            - ROLE_IBROWS_SONATA_TRANSLATION_ADMIN_ORM_EDIT
        ROLE_SONATA_TRANSLATION_ADMIN:
            - ROLE_SONATA_TRANSLATION_EDITOR
            - ROLE_IBROWS_SONATA_TRANSLATION_ADMIN_ORM_DELETE

        ROLE_SONATA_WAYFORPAY_LOG_VIEWER:
            - ROLE_MANAGER
            - ROLE_APP_ADMIN_WAYFORPAY_LOG_LIST
            - ROLE_APP_ADMIN_WAYFORPAY_LOG_VIEW
        ROLE_SONATA_WAYFORPAY_LOG_EDITOR:
            - ROLE_SONATA_WAYFORPAY_LOG_VIEWER
            - ROLE_APP_ADMIN_WAYFORPAY_LOG_CREATE
            - ROLE_APP_ADMIN_WAYFORPAY_LOG_EDIT
        ROLE_SONATA_WAYFORPAY_LOG_ADMIN:
            - ROLE_SONATA_WAYFORPAY_LOG_EDITOR
            - ROLE_APP_ADMIN_WAYFORPAY_LOG_DELETE

        ROLE_ADMIN:
            - ROLE_SONATA_TRANSLATION_ADMIN
            - ROLE_SONATA_PAGE_ADMIN
            - ROLE_SONATA_USER_ADMIN
            - ROLE_SONATA_PROMO_CODE_ADMIN
            - ROLE_SONATA_PAYMENT_ADMIN
            - ROLE_SONATA_TICKET_ADMIN
            - ROLE_SONATA_MAIL_ADMIN
            - ROLE_SONATA_SPONSOR_CATEGORY_ADMIN
            - ROLE_SONATA_SPONSOR_ADMIN
            - ROLE_SONATA_EVENT_PAGE_ADMIN
            - ROLE_SONATA_SPEAKER_ADMIN
            - ROLE_SONATA_REVIEW_ADMIN
            - ROLE_SONATA_AUDIENCE_ADMIN
            - ROLE_SONATA_GROUP_ADMIN
            - ROLE_SONATA_EVENT_ADMIN
            - ROLE_SONATA_WAYFORPAY_LOG_ADMIN
            - ROLE_VOLUNTEER
            - ROLE_SONATA_SHOW_STATISTIC
            - ROLE_SONATA_MANUAL_TICKET_SELL
            - ROLE_SONATA_CHECK_TICKET

        ROLE_SUPER_ADMIN: ROLE_ADMIN

    access_control:
        - { path: ^/login$, role: IS_AUTHENTICATED_ANONYMOUSLY }
        - { path: ^/register, role: IS_AUTHENTICATED_ANONYMOUSLY }
        - { path: ^/resetting, role: IS_AUTHENTICATED_ANONYMOUSLY }
        - { path: ^/admin/, role: [ROLE_ADMIN, ROLE_MANAGER] }
        - { path: ^/translations/, role: [ROLE_ADMIN, ROLE_MANAGER] }
        - { path: ^/addwantstovisitevent/, role: ROLE_USER }
        - { path: ^/subwantstovisitevent/, role: ROLE_USER }
        - { path: ^/payment/interaction, role: IS_AUTHENTICATED_ANONYMOUSLY }
        - { path: /pay$, role: ROLE_USER }